function lockBtn(t,n){var e=$(t);e.attr("disabled","disabled"),isBtn(e)?e.text(n):e.val(n)}function unlockBtn(t,n){var e=$(t);e.removeAttr("disabled"),isBtn(e)?e.text(n):e.val(n)}function isBtn(t){var n=$(t)[0].nodeName;return"BUTTON"===n?!0:!1}function debounce(t,n){var e=null;return function(){clearTimeout(e),e=setTimeout(t,n)}}!function(t){t.fn.validate=function(n){function e(){unlockBtn(c),n.touch&&c.on("click",o).on("tap",function(){t(this).is(":disabled")||a()}),u.on("submit",function(t){o(t),i(u)&&(lockBtn(c,n.loadingTxt),l(u))})}function o(t){t.preventDefault()}function a(){u.trigger("submit")}function i(t){for(var e=t.serializeArray(),o=0;o<e.length;o++){var a=validConfig[e[o].name],i=e[o].value;if(a){if(""==i)return n.alertFn.call(null,a.required),!1;if(a.reg&&!a.reg.exp.test(i))return n.alertFn.call(null,a.reg.msg),!1}}return!0}function l(e){var o=e.serializeArray(),a={};t.each(o,function(t,n){a[n.name]=n.value}),n.validSuccess.call(c,a)}var r={validConf:{},touch:!0,loadingTxt:"正在提交",validSuccess:function(){},alertFn:window.alert};n=t.extend(r,n||{});var u=t(this);if("FORM"!==u[0].nodeName)throw new Error("the element must be a form");var c=u.find('input[type="submit"]');e()}}(Zepto),function(t){t.fn.getCode=function(n){function e(){var t=n.validReg.test(l.val()),e=window.localStorage.getItem(n.countTag);e||(t?unlockBtn(r,n.defaultTxt):lockBtn(r,n.defaultTxt))}function o(){function t(){var t=(new Date).getTime(),i=n.countTime-Math.floor((t-o)/1e3);0>=i?(window.localStorage.removeItem(n.countTag),unlockBtn(r,n.defaultTxt),e()):r.val(a(i))}var o=window.localStorage.getItem(n.countTag);clearInterval(u),t(),u=setInterval(t,1e3)}function a(t){return[n.insertStr,t,n.appendStr].join("")}var i={countTime:180,countTag:"countTime",bind:"#mobile",validReg:/(.*)+/,defaultTxt:"获取验证码",needRefresh:!1,debounce:100,touch:!0,insertStr:"等待",appendStr:"秒后,再次获取",sendCode:function(){}};n=t.extend(i,n||{});var l=t(n.bind),r=t(this),u=null;lockBtn(r,n.defaultTxt),n.needRefresh?window.localStorage.removeItem(n.countTag):o();var c=debounce(e,n.debounce);e(),l.on("input",c);var d=n.touch?"tap":"click";r.on(d,function(){var e=t(this),i=e.is(":disabled");i||(window.localStorage.setItem(n.countTag,(new Date).getTime()),lockBtn(r,a(n.countTime)),o(),n.sendCode.call(r,l.val()))})}}(Zepto);