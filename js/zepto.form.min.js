!function(t){t.fn.validate=function(e){function n(){t.unlockBtn(c,e.defaultTxt),e.touch&&c.on("click",o).on("tap",function(){t(this).is(":disabled")||a()}),u.on("submit",function(n){o(n),i(u)&&(t.lockBtn(c,e.loadingTxt),l(u))})}function o(t){t.preventDefault()}function a(){u.trigger("submit")}function i(t){for(var n=t.serializeArray(),o=0;o<n.length;o++){var a=e.validConf[n[o].name],i=n[o].value;if(a){if(""==i)return e.alertFn.call(null,a.required),!1;if(a.reg&&!a.reg.exp.test(i))return e.alertFn.call(null,a.reg.msg),!1}}return!0}function l(n){var o=n.serializeArray(),a={};t.each(o,function(t,e){a[e.name]=e.value}),e.validSuccess.call(c,a)}var r={validConf:{},touch:!0,loadingTxt:"正在提交",defaultTxt:"提交",validSuccess:function(){},alertFn:window.alert};e=t.extend(r,e||{});var u=t(this);if("FORM"!==u[0].nodeName)throw new Error("the element must be a form");var c=u.find('input[type="submit"]');n()}}(Zepto),function(t){t.fn.getCode=function(e){function n(){var n=e.validReg.test(l.val()),o=window.localStorage.getItem(e.countTag);o||(n?t.unlockBtn(r,e.defaultTxt):t.lockBtn(r,e.defaultTxt))}function o(){function o(){var o=(new Date).getTime(),l=e.countTime-Math.floor((o-i)/1e3);0>=l?(window.localStorage.removeItem(e.countTag),t.unlockBtn(r,e.defaultTxt),n()):r.val(a(l))}var i=window.localStorage.getItem(e.countTag);clearInterval(u),o(),u=setInterval(o,1e3)}function a(t){return[e.insertStr,t,e.appendStr].join("")}var i={countTime:180,countTag:"countTime",bind:"#mobile",validReg:/(.*)+/,defaultTxt:"获取验证码",needRefresh:!1,debounce:100,touch:!0,insertStr:"等待",appendStr:"秒后,再次获取",sendCode:function(){}};e=t.extend(i,e||{});var l=t(e.bind),r=t(this),u=null;t.lockBtn(r,e.defaultTxt),e.needRefresh?window.localStorage.removeItem(e.countTag):o();var c=t.debounce(n,e.debounce);n(),l.on("input",c);var d=e.touch?"tap":"click";r.on(d,function(){var n=t(this),i=n.is(":disabled");i||(window.localStorage.setItem(e.countTag,(new Date).getTime()),t.lockBtn(r,a(e.countTime)),o(),e.sendCode.call(r,l.val()))})}}(Zepto),$.lockBtn=function(t,e){var n=$(t);n.attr("disabled","disabled"),$.isBtn(n)?n.text(e):n.val(e)},$.unlockBtn=function(t,e){var n=$(t);n.removeAttr("disabled"),$.isBtn(n)?n.text(e):n.val(e)},$.isBtn=function(t){var e=$(t)[0].nodeName;return"BUTTON"===e?!0:!1},$.debounce=function(t,e){var n=null;return function(){clearTimeout(n),n=setTimeout(t,e)}};